{% extends "base.html" %}

{% block content %}
  <script type="text/javascript">
    window.onload=function() {
      document.add_new_message.message.focus();
    }
  </script>
  <center>
  {% if write_access %}
    {% if error_message %}
      <div class="error">
      {{ error_message }}
      </div>
    {% endif %}
    <form action="/" name="add_new_message" method="post">
      <input type="text" size="80" name="message" value="{{ message }}">
      <input type="hidden" name="last_status_key" value="{{ last_status_key }}">
      <input type="submit" name="change" value="Change">
      <input type="button" name="refresh" value="Refresh" onclick="location.href='/';">
      <input type="button" name="history" value="History" onclick="location.href='/status_viewer';">
    </form>
  {% endif %}
  <br>
  <h2>Last <a href="?limit={{ limit }}">{{ limit }}</a> {{ title }}</h2>
  <table border="1" cellpadding="5">
  <tr bgcolor="#CCCCFF">
    <td><b>Who</b></td>
    <td><b>When (UTC)</b></td>
    <td><b>Message</b></td>
  </tr>
  {% for a_status in status %}
    <tr class="{{ a_status.general_state }}">
      <td class="username">
        {% for a_link in a_status.username_links.links %}
          {% if a_link.target %}
            <a href="{% if a_link.is_email %}mailto:{% endif %}{{ a_link.target }}">{{ a_link.text }}</a>
          {% else %}
            {{ a_link.text }}
          {% endif %}
        {% endfor %}
      </td>
      <td class="date">{{ a_status.date|date:"D, d M H:i" }}</td>
      <td class="message">
        {% for a_link in a_status.message_links.links %}
          {% if a_link.target %}
            <a href="{% if a_link.is_email %}mailto:{% endif %}{{ a_link.target }}">{{ a_link.text }}</a>
          {% else %}
            {{ a_link.text }}
          {% endif %}
        {% endfor %}
      </td>
    </tr>
  {% endfor %}

  </table>
  </center>
{% endblock %}
