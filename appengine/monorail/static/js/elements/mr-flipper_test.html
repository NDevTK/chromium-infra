<meta charset="utf-8">
<script src="/bower_components/webcomponentsjs/webcomponents-loader.js"></script>
<script src="/bower_components/web-component-tester/browser.js"></script>
<script type="module" src="/static/js/elements/mr-flipper.js"></script>

<test-fixture id="basic">
  <template>
    <mr-flipper></mr-flipper>
  </template>
</test-fixture>

<script type="module">
suite('basic tests', function() {
  let element;

  setup(function() {
    element = fixture('basic');
    sinon.stub(window, 'fetch');

    const response = new window.Response('Ok.', {
      status: 201,
      headers: {
        'Content-type': 'application/json',
      },
    });
    window.fetch.returns(Promise.resolve(response));
  });

  teardown(function() {
    window.fetch.restore();
  });

  test('renders', function(done) {
    assert.isDefined(element, 'element is defined');
    const prevUrlEl = element.shadowRoot.querySelector('a.prev-url');
    const nextUrlEl = element.shadowRoot.querySelector('a.next-url');
    const listUrlEl = element.shadowRoot.querySelector('a.list-url');
    const countsEl = element.shadowRoot.querySelector('div.counts');

    // Test DOM after properties are updated.
    element._updateTemplate({
      cur_index: 4,
      total_count: 13,
      prev_url: 'http://prevurl/',
      next_url: 'http://nexturl/',
      list_url: 'http://listurl/',
    });
    assert.include(countsEl.innerText, '5 of 13');
    assert.equal(prevUrlEl.href, 'http://prevurl/');
    assert.equal(nextUrlEl.href, 'http://nexturl/');
    assert.equal(listUrlEl.href, 'http://listurl/');

    done();
  });
});
</script>
