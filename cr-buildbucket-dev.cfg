# Defines buckets on cr-buildbucket-dev.appspot.com.
#
# This is STAGING instance of LUCI. It should not be used for anything
# important.
#
# See https://luci-config.appspot.com/schemas/projects:buildbucket.cfg for
# schema of this file and documentation.

buckets {
  name: "luci.infra.ci"
  acls {
    role: READER
    group: "all"
  }
  acls {
    role: SCHEDULER
    identity: "luci-scheduler-dev@appspot.gserviceaccount.com"
  }

  swarming {
    hostname: "chromium-swarm-dev.appspot.com"
    builder_defaults {
      swarming_tags: "allow_milo:1"
      dimensions: "pool:Chrome"  # No point in creating a dedicated pool on -dev.
      execution_timeout_secs: 1800  # 30 min
      build_numbers: YES
      recipe {
        name: "infra_continuous"
        cipd_package: "infra/recipe_bundles/chromium.googlesource.com/infra/infra"
        cipd_version: "refs/heads/master"
      }
      service_account: "adhoc-testing@luci-token-server-dev.iam.gserviceaccount.com"
    }

    builders {
      name: "infra-continuous-trusty-64"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
    }

    builders {
      name: "infra-continuous-win-64"
      dimensions: "os:Windows-7-SP1"
      dimensions: "cpu:x86-64"
    }

    builders {
      name: "infra-continuous-win10-64"
      dimensions: "os:Windows-10"
      dimensions: "cpu:x86-64"
    }

    builders {
      name: "goma-hello-world-trusty-64"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
      recipe {
        name: "goma_hello_world"
      }
    }

    builders {
      name: "gerrit-hello-world-trusty-64"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
      recipe {
        name: "gerrit_hello_world"
      }
    }

    builders {
      name: "gsutil-hello-world-trusty-64"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "cpu:x86-64"
      recipe {
        name: "gsutil_hello_world"
      }
    }

    builders {
      name: "gsutil-hello-world-win10-64"
      dimensions: "os:Windows-10"
      dimensions: "cpu:x86-64"
      recipe {
        name: "gsutil_hello_world"
      }
    }
  }
}

buckets {
  name: "luci.infra.tricium"

  # In normal operation, jobs will be triggered by a public Tricium
  # instance, but they could also be triggered manually.
  acls {
    role: SCHEDULER
    group: "googlers"
  }
  acls {
    role: SCHEDULER
    identity: "tricium-dev@appspot.gserviceaccount.com"
  }

  swarming {
    hostname: "chromium-swarm-dev.appspot.com"

    # Both recipe and platform dimensions will be explicitly
    # overridden in builds triggered by the Tricium service.
    builders {
      name: "tricium"
      recipe {
        cipd_package: "infra/recipe_bundles/chromium.googlesource.com/infra/infra"
        cipd_version: "refs/heads/master"
        name: "tricium_noop"
      }
      dimensions: "cpu:x86-64"
      dimensions: "os:Ubuntu-14.04"
      dimensions: "pool:tricium"
      execution_timeout_secs: 600  # 10 minutes
      service_account: "infra-tricium-dev@chops-service-accounts.iam.gserviceaccount.com"
    }
  }
}
