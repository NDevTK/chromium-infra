// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

syntax = "proto3";

package dashboard;

// The ChromeOps statuses service definition.
service ChopsServiceStatus {
  rpc ListServices (ListServicesRequest) returns (ListServicesResponse) {}
  rpc GetService (GetServiceRequest) returns (ChopsService) {}
  rpc GetServiceStatus (GetServiceStatusRequest) returns (GetServiceStatusResponse) {}
  rpc ListIncidents (ListIncidentsRequest) returns (ListIncidentsResponse){}
  rpc GetIncident (GetIncidentRequest) returns (Incident) {}
  rpc CreateIncident (CreateIncidentRequest) returns (Incident) {}
  rpc UpdateIncident (UpdateIncidentRequest) returns (Incident) {}
}

message ListServicesRequest {
  // The maximum number of items to return.
  int32 page_size = 1;

  // The next_page_token value returned from a previous List request, if any.
  string page_token = 2;
}

message ListServicesResponse {
  repeated ChopsService services = 1;
  string next_page_token = 2;
}

message GetServiceRequest {
  string service_name = 1;
}

message GetServiceStatusRequest {
  string service_name = 1;
}

message GetServiceStatusResponse {
  int32 service_status = 1;
}

message ListIncidentsRequest {
  string service_name = 1;
  int32 page_size = 2;
  string page_token = 3;
}

message ListIncidentsResponse {
  repeated Incident incidents = 1;
  string next_page_token = 2;
}

message GetIncidentRequest {
  string service_name = 1;
  string incident_id = 2;
}

message CreateIncidentRequest {
  string service_name = 1;
  Incident incident = 2;
}

message UpdateIncidentRequest {
  Incident incident = 1;
  string service_name = 2;
  string incident_id = 3;
}

message Incident {
  string id = 1;
  bool open = 2;
  string start_time = 3;
  string end_time = 4;
  int32 severity = 5;
}

message ChopsService {
  string name = 1;
  repeated Incident incidents = 2;
  string sla = 3;
}