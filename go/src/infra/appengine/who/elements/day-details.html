<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-tooltip/paper-tooltip.html">

<dom-module id="day-details">
  <template>
    <style>
    </style>

    Details for [[day]]

    <template is="dom-if" if="[[bugs]]">
      <table>
        <tr>
          <th>Time</th>
          <th>Bug</th>
        </tr>
        <template is="dom-repeat" items="[[bugs]]">
          <tr>
          <td>[[formatDate_(item.updated)]]</td>
          <td><a href="https://crbug.com/[[item.id]]">[[item.summary]]</a></td>
          </tr>
        </template>
      </table>
    </template>

    <template is="dom-if" if="[[changes]]">
      <table>
        <tr>
          <th>Time</th>
          <th>CLs</th>
        </tr>
        <template is="dom-repeat" items="[[changes]]">
          <tr>
          <td>[[formatDate_(item.updated)]]</td>
          <td><a href="https://chromium-review.googlesource.com/[[item._number]]">[[item.subject]]</a></td>
          </tr>
        </template>
      </table>
    </template>

  </template>
  <script>
    'use strict';

    class DayDetails extends Polymer.Element {
      static get is() { return 'day-details'; }

      // TODO(jojwang): for now assuming these come in order
      // if not, I will sort by time.
      // TODO(jojwang): put all links on the same timeline, if time allows.
      // For now, assuming these are all arrays of Object{time, link}.
      static get properties() {
        return {
          changes: {
            type: Array,
            value: () => { return []; }
          },
          bugs: {
            type: Array,
            value: () => { return []; }
          },
          day: Date,
        }
      }

      formatDate_(dateString) {
        const date = new Date(dateString);
        const hour = date.getHours();
        let min = date.getMinutes();
        if (min < 10) min = '0' + min;
        return `${hour}:${min}`;
      }
    }
    customElements.define(DayDetails.is, DayDetails);
  </script>
</dom-module>
